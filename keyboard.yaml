meta:
  engine: 4.1.0
  author: "hasbii"
units:
  a: 0.5
  mcuw: 21
  mcuh: 51
points:
  key.tags:
    - key
  zones:
    matrix:
      columns:
        c6:
        c5:
        c4.key:
          stagger: u/4
        c3.key:
          stagger: u/4
        c2.key:
          stagger: -u/4
        c1.key:
          stagger: -u/4
      rows:
        r3:
        r2:
        r1:

    thumbfan:
      anchor:
        ref: matrix_c4_r3
        shift: [u/2+2, -u-u/3]
      columns:
        c5:
          rows:
            r1.skip: true
        c4:
          rows:
            r1.skip: true
        c3:
          key:
            splay: -12
            origin: [-u/2, -u/2]
          rows:
            r1.skip: true
        c2.key:
          splay: -12
          origin: [-u/2, -u/2]
        c1.key:
          splay: -12
          origin: [-u/2, -u/2]
      rows:
        r2:
        r1:

    mcu:
      key.tags:
        - helper
      anchor:
        - ref: matrix_c1_r2
          shift: [u+3, 7]

    board_screw_1:
      key.tags:
        - board_screw
      anchor:
        aggregate.parts:
          - ref: matrix_c1_r1
          - ref: matrix_c2_r1
          - ref: matrix_c1_r2
          - ref: matrix_c2_r2
    board_screw_2:
      key.tags:
        - board_screw
      anchor:
        aggregate.parts:
          - ref: matrix_c3_r3
        shift: [0, -u/2-6]
    board_screw_3:
      key.tags:
        - board_screw
      anchor:
        aggregate.parts:
          - ref: thumbfan_c1_r1
          - ref: thumbfan_c2_r1
          - ref: thumbfan_c2_r2
          - ref: thumbfan_c1_r2
        shift: [0, 1]
    board_screw_4:
      key.tags:
        - board_screw
      anchor:
        aggregate.parts:
          - ref: matrix_c5_r1
          - ref: matrix_c6_r1
          - ref: matrix_c6_r2
          - ref: matrix_c5_r2
    board_screw_5:
      key.tags:
        - board_screw
      anchor:
        aggregate.parts:
          - ref: matrix_c5_r2
          - ref: matrix_c6_r2
          - ref: matrix_c6_r3
          - ref: matrix_c5_r3

outlines:
  _keycaps:
    - what: rectangle
      where: [key]
      size: 18
      fillet: 3
  _mcu:
    - what: rectangle
      where: [helper]
      size: [mcuw, mcuh]
  _board_screw_heads:
    - what: circle
      where: [board_screw]
      radius: 4.3/2
  board:
    - what: outline
      name: _keycaps
    - what: outline
      name: _mcu
    - what: polygon
      points:
        - ref: matrix_c6_r1
          shift: [-u/2-a, u/2+a]
        - ref: matrix_c5_r1
          shift: [u/2-a, u/2+a]
        - ref: matrix_c4_r1
          shift: [-u/2-a, u/2+a]
        - ref: matrix_c4_r1
          shift: [u/2-a, u/2+a]
        - ref: matrix_c3_r1
          shift: [-u/2-a, u/2+a]
        - ref: matrix_c3_r1
          shift: [u/2+a, u/2+a]
        - ref: matrix_c2_r1
          shift: [-u/2+a, u/2+a]
        - ref: mcu
          shift: [mcuw/2+a*3, 0]
          affect: [x]
        - ref: mcu
          shift: [0, -mcuh/2-6-a]
          affect: [y]
        - ref: thumbfan_c1_r1
          shift: [-u/2+a, u/2+a]
        - ref: thumbfan_c1_r1
          shift: [u/2+a, u/2+a]
        - ref: thumbfan_c1_r2
          shift: [u/2+a, -u/2-a]
        - ref: thumbfan_c1_r2
          shift: [-u/2-a, -u/2-a]
        - ref: thumbfan_c2_r2
          shift: [-u/2-a, -u/2-a]
        - ref: thumbfan_c3_r2
          shift: [-u/2-a, -u/2-a]
        - ref: thumbfan_c5_r2
          shift: [-u/2-a, -u/2-a]
        - ref: thumbfan_c5_r2
          shift: [-u/2-a, u/2+a]
        - ref: matrix_c6_r3
          shift: [-u/2-a, 0]
          affect: [x]
        - ref: matrix_c6_r1
          shift: [-u/2-a, u/2+a]
  preview:
    - what: outline
      name: board
    - what: outline
      name: _keycaps
      operation: stack
    - what: outline
      name: _mcu
      operation: stack
    - what: outline
      name: _board_screw_heads
      operation: stack
